<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document View Test</title>
  <link rel="stylesheet" href="/styles/design-system.css">
  <link rel="stylesheet" href="/styles/app-shell.css">
  <link rel="stylesheet" href="/styles/document-view.css">
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: var(--font-primary);
    }
    .test-controls {
      position: fixed;
      top: 10px;
      right: 10px;
      background: white;
      padding: 10px;
      border-radius: 8px;
      box-shadow: var(--shadow-lg);
      z-index: 1000;
    }
    .test-controls button {
      margin: 5px;
      padding: 8px 16px;
      border: 1px solid var(--color-border);
      background: var(--color-surface);
      border-radius: var(--radius-sm);
      cursor: pointer;
    }
    .test-controls button:hover {
      background: var(--color-hover);
    }
  </style>
</head>
<body>
  <div class="test-controls">
    <h4 style="margin: 0 0 10px 0;">Test Controls</h4>
    <button onclick="loadMockData()">Load Mock Document</button>
    <button onclick="loadEmptyData()">Test Empty State</button>
    <button onclick="clearView()">Clear View</button>
  </div>

  <div id="app"></div>

  <script type="module">
    import { DocumentView } from '/components/views/DocumentView.js';

    let currentView = null;

    // Mock document data for testing
    const mockDocumentData = {
      title: "Enterprise Cloud Migration Strategy",
      subtitle: "Comprehensive Guide to AWS Migration",
      meta: {
        author: "Cloud Architecture Team",
        date: "November 2025",
        version: "1.0"
      },
      tableOfContents: [
        { id: "executive-summary", title: "Executive Summary", level: 1 },
        { id: "background", title: "Background", level: 1 },
        { id: "current-state", title: "Current State", level: 2 },
        { id: "challenges", title: "Challenges", level: 2 },
        { id: "migration-strategy", title: "Migration Strategy", level: 1 },
        { id: "timeline", title: "Timeline", level: 2 },
        { id: "budget", title: "Budget", level: 2 },
        { id: "technical-approach", title: "Technical Approach", level: 1 },
        { id: "recommendations", title: "Recommendations", level: 1 }
      ],
      sections: [
        {
          id: "executive-summary",
          heading: "Executive Summary",
          level: 1,
          content: [
            {
              type: "paragraph",
              text: "This document outlines a comprehensive strategy for migrating our enterprise infrastructure to AWS cloud services. The migration will modernize our technology stack, improve scalability, and reduce operational costs by approximately 30% over three years."
            },
            {
              type: "paragraph",
              text: "Our analysis indicates that a phased migration approach, starting with non-critical workloads and progressing to mission-critical systems, will minimize risk while delivering value incrementally."
            },
            {
              type: "list",
              ordered: false,
              items: [
                "Total migration timeline: 18 months",
                "Estimated cost savings: $2.4M annually",
                "ROI payback period: 24 months",
                "Zero planned downtime for critical systems"
              ]
            }
          ]
        },
        {
          id: "background",
          heading: "Background",
          level: 1,
          content: [
            {
              type: "paragraph",
              text: "Our current infrastructure consists of on-premises data centers hosting over 200 applications serving 50,000 employees across 15 global offices. The infrastructure has reached end-of-life for many components, requiring significant capital investment for hardware refresh."
            }
          ]
        },
        {
          id: "current-state",
          heading: "Current State Assessment",
          level: 2,
          content: [
            {
              type: "paragraph",
              text: "We conducted a comprehensive assessment of our existing infrastructure and identified the following characteristics:"
            },
            {
              type: "table",
              headers: ["Category", "Current State", "Challenges"],
              rows: [
                ["Compute", "500 physical servers", "High maintenance, low utilization (avg 40%)"],
                ["Storage", "2PB on-premises SAN", "Limited scalability, expensive expansion"],
                ["Network", "Legacy MPLS", "High latency, bandwidth constraints"],
                ["Applications", "200+ apps", "Mix of modern and legacy, varied tech stacks"]
              ]
            }
          ]
        },
        {
          id: "challenges",
          heading: "Key Challenges",
          level: 2,
          content: [
            {
              type: "list",
              ordered: true,
              items: [
                "Hardware end-of-life requiring $5M capital investment",
                "Limited disaster recovery capabilities",
                "Slow provisioning times (weeks vs hours)",
                "Difficulty scaling during peak demand",
                "Compliance and security concerns with aging infrastructure"
              ]
            }
          ]
        },
        {
          id: "migration-strategy",
          heading: "Migration Strategy",
          level: 1,
          content: [
            {
              type: "paragraph",
              text: "We will employ a three-phase migration approach leveraging AWS's 6R strategy framework: Rehost (lift-and-shift), Replatform (optimize), and Refactor (modernize)."
            },
            {
              type: "quote",
              text: "The key to successful cloud migration is balancing speed with risk mitigation. Start small, learn fast, and scale with confidence.",
              attribution: "AWS Well-Architected Framework"
            }
          ]
        },
        {
          id: "timeline",
          heading: "Migration Timeline",
          level: 2,
          content: [
            {
              type: "table",
              headers: ["Phase", "Duration", "Workloads", "Completion"],
              rows: [
                ["Phase 1: Dev/Test", "Q1 2026", "Non-production workloads", "March 2026"],
                ["Phase 2: Secondary Apps", "Q2-Q3 2026", "Internal tools, reporting", "September 2026"],
                ["Phase 3: Critical Apps", "Q4 2026 - Q2 2027", "Customer-facing, ERP", "June 2027"]
              ]
            }
          ]
        },
        {
          id: "budget",
          heading: "Budget Analysis",
          level: 2,
          content: [
            {
              type: "paragraph",
              text: "Total project budget: $8.5M over 18 months, with expected annual savings of $2.4M beginning year 2."
            },
            {
              type: "list",
              ordered: false,
              items: [
                "Migration services & consulting: $3.2M",
                "AWS infrastructure (year 1): $2.8M",
                "Training and enablement: $1.2M",
                "Tooling and automation: $800K",
                "Contingency (15%): $500K"
              ]
            }
          ]
        },
        {
          id: "technical-approach",
          heading: "Technical Approach",
          level: 1,
          content: [
            {
              type: "paragraph",
              text: "Our technical approach emphasizes automation, security, and operational excellence. We will implement Infrastructure as Code (IaC) using Terraform, establish CI/CD pipelines, and adopt AWS native services where appropriate."
            },
            {
              type: "list",
              ordered: false,
              items: [
                "Multi-account strategy with AWS Organizations",
                "Hub-and-spoke network architecture with Transit Gateway",
                "Centralized logging and monitoring with CloudWatch",
                "Automated compliance scanning with AWS Config",
                "Disaster recovery with cross-region replication"
              ]
            }
          ]
        },
        {
          id: "recommendations",
          heading: "Recommendations",
          level: 1,
          content: [
            {
              type: "paragraph",
              text: "Based on our analysis, we recommend proceeding with the migration plan as outlined. The business case is compelling, with significant cost savings, improved agility, and reduced operational risk."
            },
            {
              type: "list",
              ordered: true,
              items: [
                "Establish cloud center of excellence (CCOE) in Q4 2025",
                "Begin pilot migration with 10 non-critical applications in Q1 2026",
                "Invest in team training and AWS certification programs",
                "Partner with AWS Professional Services for initial phases",
                "Conduct quarterly governance reviews to ensure alignment"
              ]
            },
            {
              type: "quote",
              text: "Cloud migration is not just a technology projectâ€”it's a business transformation that requires executive sponsorship, cross-functional collaboration, and cultural change.",
              attribution: "Enterprise Architecture Team"
            }
          ]
        }
      ]
    };

    window.loadMockData = function() {
      clearView();

      console.log('Loading mock document data...');
      currentView = new DocumentView(mockDocumentData);
      const container = currentView.render();
      document.getElementById('app').appendChild(container);
      console.log('âœ… Document view rendered with', mockDocumentData.sections.length, 'sections');
    };

    window.loadEmptyData = function() {
      clearView();

      console.log('Loading empty state...');
      currentView = new DocumentView(null);
      const container = currentView.render();
      document.getElementById('app').appendChild(container);
      console.log('âœ… Empty state rendered');
    };

    window.clearView = function() {
      if (currentView) {
        currentView.destroy();
        currentView = null;
      }
      document.getElementById('app').innerHTML = '';
      console.log('âœ… View cleared');
    };

    // Auto-load mock data on page load
    console.log('ðŸ§ª Document View Test Page Loaded');
    console.log('Scroll to see the table of contents scroll spy in action');
    loadMockData();
  </script>
</body>
</html>
